# PVC Contact差异识别系统 - 使用说明

## 快速开始

### 1. 安装依赖

打开命令行，在项目目录下运行：

```bash
pip install -r requirements.txt
```

### 2. 启动应用

**Windows用户：**
- 双击 `run.bat` 文件，或
- 在命令行运行：`streamlit run app.py`

**Linux/Mac用户：**
```bash
streamlit run app.py
```

### 3. 使用应用

应用启动后，浏览器会自动打开（默认地址：http://localhost:8501）

## 功能说明

### 📸 单图分析

用于分析单张PVC图像中的Contact：

1. **选择图像来源**
   - Demo图片：使用 `VC_images/Service_MA_SEM_09.jpg`
   - 上传图片：上传您自己的PVC图像

2. **查看结果**
   - Contact检测统计（总数、正常数、异常数）
   - 可视化结果（原图标记所有Contact）
   - 异常Contact详细信息
   - Contact详细数据表

3. **参数调整**
   - 在侧边栏调整检测参数以获得最佳效果
   - 最小/最大Contact尺寸：过滤掉过小或过大的区域
   - 高/低亮度阈值：区分VDD和GND区域

### 🔍 双图对比

用于对比两张PVC图像，找出差异Contact：

1. **上传图像**
   - 参考图像：正常或标准的PVC图像
   - 对比图像：需要检查的图像

2. **开始分析**
   - 点击"开始对比分析"按钮
   - 系统会自动匹配位置相近的Contact
   - 对比亮度差异，找出异常Contact

3. **查看差异**
   - 差异Contact列表
   - 每个差异的详细对比信息
   - 亮度差异值

## PVC原理说明

根据PVC（Passive Voltage Contrast）技术：

- **亮区域（高亮度）**：高电位（VDD）
  - 排斥电子束，二次电子易逸出
  - 图像表现为亮色
  
- **暗区域（低亮度）**：低电位（GND/接地）
  - 吸引电子，二次电子难逸出
  - 图像表现为暗色

- **异常区域**：可能的问题
  - 浮空节点：亮度异常（介于亮暗之间）
  - 开路：与预期亮度不符
  - 短路：与周围区域亮度一致（无对比）

## 检测算法说明

### Contact检测
- 使用自适应阈值二值化
- 形态学操作连接断开的区域
- 轮廓检测识别Contact区域
- 过滤过小或过大的区域

### 异常判断标准
1. **亮度异常**：亮度不在正常VDD或GND范围内
2. **对比度异常**：
   - 对比度过小（<10）：可能短路
   - 对比度过大（>100）：可能开路
3. **形状异常**：圆形度<0.5，形状不规则

## 参数调整建议

### 最小/最大Contact尺寸
- 根据图像分辨率调整
- 如果检测到太多噪声，增大最小尺寸
- 如果漏检Contact，减小最小尺寸

### 亮度阈值
- **高亮度阈值**：用于识别VDD区域
  - 默认180，可根据实际图像调整
  - 如果VDD区域未被识别，降低阈值
- **低亮度阈值**：用于识别GND区域
  - 默认80，可根据实际图像调整
  - 如果GND区域未被识别，提高阈值

## 注意事项

1. **图像质量**
   - 建议使用清晰的SEM图像
   - 图像对比度要足够
   - 避免过度曝光或欠曝光

2. **参数优化**
   - 不同图像可能需要不同的参数
   - 建议先用Demo图片熟悉功能
   - 根据实际效果调整参数

3. **结果解释**
   - 检测结果仅供参考
   - 需要结合实际电路分析
   - 异常Contact需要进一步验证

## 故障排除

### 应用无法启动
- 检查是否安装了所有依赖：`pip install -r requirements.txt`
- 检查Python版本（建议3.8+）
- 检查端口8501是否被占用

### 检测结果不准确
- 调整侧边栏参数
- 检查图像质量和对比度
- 尝试不同的检测方法（自适应/Otsu阈值）

### 图像无法加载
- 检查图像格式（支持jpg, png, tif等）
- 检查图像路径是否正确
- 确保图像文件没有损坏

## 技术支持

如有问题或建议，请检查：
- README.md：项目说明
- 什么是PVC.md：PVC技术原理说明

