# 安装说明

## 问题：安装依赖时遇到编译错误

如果在安装 `requirements.txt` 时遇到编译错误（特别是numpy），可以使用以下解决方案：

## 解决方案

### 方案1：使用Conda安装（推荐）⭐

如果您使用Conda/Miniconda，这是最简单的方法：

```bash
# 创建新环境
conda create -n contactscan python=3.10

# 激活环境
conda activate contactscan

# 使用conda安装大部分依赖
conda install -c conda-forge streamlit numpy pillow matplotlib pandas opencv

# 或者使用environment.yml文件
conda env create -f environment.yml
conda activate contactscan
```

### 方案2：使用预编译的wheel包

已更新 `requirements.txt` 使用兼容的numpy版本（<2.0.0），应该可以直接安装预编译包：

```bash
pip install -r requirements.txt
```

如果仍然有问题，可以逐个安装：

```bash
pip install streamlit
pip install "numpy<2.0.0"
pip install opencv-python
pip install pillow
pip install matplotlib
pip install pandas
```

### 方案3：安装Visual Studio Build Tools（不推荐）

如果需要从源码编译，需要安装Visual Studio Build Tools：

1. 下载并安装 [Microsoft C++ Build Tools](https://visualstudio.microsoft.com/visual-cpp-build-tools/)
2. 选择"C++ build tools"工作负载
3. 安装完成后重新运行 `pip install -r requirements.txt`

### 方案4：使用预编译的wheel文件

如果pip仍然尝试从源码编译，可以指定使用wheel：

```bash
pip install --only-binary :all: -r requirements.txt
```

或者强制使用wheel：

```bash
pip install --prefer-binary -r requirements.txt
```

## 验证安装

安装完成后，验证是否成功：

```bash
python -c "import streamlit; import cv2; import numpy; import pandas; print('所有依赖安装成功！')"
```

## 常见问题

### Q: 仍然遇到编译错误怎么办？

A: 建议使用方案1（Conda），它会自动处理所有依赖和编译问题。

### Q: 使用conda后如何运行应用？

A: 
```bash
conda activate contactscan
streamlit run app.py
```

### Q: 可以混用conda和pip吗？

A: 可以，但建议优先使用conda安装，只有在conda没有的包时才用pip。

## 快速开始（推荐流程）

```bash
# 1. 创建conda环境
conda create -n contactscan python=3.10 -y

# 2. 激活环境
conda activate contactscan

# 3. 安装依赖
conda install -c conda-forge streamlit numpy pillow matplotlib pandas opencv -y

# 4. 运行应用
streamlit run app.py
```

